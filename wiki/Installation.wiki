#summary Installation Instructions
#labels Featured,Phase-Deploy

= Introduction =

The [http://dblinq2007.googlecode.com/files/DbLinq-0.19.zip DbLinq-0.19.zip] file contains the DbLinq binaries such as `DbMetal.exe` and `DbLinq.dll`.  However, these are not usable by themselves.  No ADO.NET providers are distributed with DbLinq, and ADO.NET providers are needed in order for DbLinq to interact with databases.

DbLinq only uses standard ADO.NET interfaces in order to interact with databases.  An ADO.NET provider (e.g. `System.Data.SQLite.dll`) in combination with a DbLinq provider (e.g. `DbLinq.Sqlite.dll`) is needed in order for DbLinq to interact with a database.

= !DbLinq provider assemblies =

DbLinq ships with provider assemblies which implement support for various SQL "dialects."  DbLinq provider assemblies may be usable by multiple different ADO.NET providers; what's important is that the the DbLinq provider is responsible for generating SQL for a given database, and may refer to various database-specific internal tables, e.g. to retrieve the primary key of a recently inserted row.

The DbLinq provider assemblies include:

  * `DbLinq.Firebird.dll`: [http://www.firebirdsql.org/ Firebird] support.
  * `DbLinq.Ingres.dll`: [http://www.ingres.com/ Ingres] support.
  * `DbLinq.MySql.dll`: [http://www.mysql.com/ MySQL] support.
  * `DbLinq.Oracle.dll`: [http://www.oracle.com/ Oracle] support, using either the System.Data.OracleClient or [http://www.oracle.com/technology/software/tech/windows/odpnet/index.html Oracle.DataAccess] drivers.
  * `DbLinq.PostgreSql.dll`: [http://www.postgresql.org/ PostgreSQL] support.
  * `DbLinq.Sqlite.dll`: [http://www.sqlite.org/ SQLite] support, using either the [http://sqlite.phxsoftware.com/ System.Data.SQLite] or [http://www.mono-project.com/SQLite Mono.Data.Sqlite] drivers.
  * `DbLinq.SqlServer.dll`: [http://www.microsoft.com/sqlserver/ Microsoft SQL Server] support.

= To run !DbMetal =

DbMetal has two modes of operation:

  # Connecting to a database to generate either a `.dbml` or source code containing entities, for example:
{{{
DbMetal /provider:Sqlite /conn "Data Source=File.db3" /dbml:File.dbml
}}}
  # Generating source code containing entities contained in a `.dbml` file, for example:
{{{
DbMetal /code:File.cs File.dbml
}}}

Both of these require both an ADO.NET provider and a DbLinq provider for your database.  DbLinq provider assemblies are bundled with DbLinq, e.g. `DbLinq.Sqlite.dll`.

There are three ways that the ADO.NET provider can be used with `DbMetal.exe`:

  # Copy the ADO.NET provider assembly into the DbLinq installation directory.  For example, for [http://www.mysql.com/ MySQL] support the [http://dev.mysql.com/downloads/connector/net/ MySql.Data.dll] assembly should be copied into the same directory as `DbMetal.exe`.
  # If your ADO.NET provider is present within the Global Assembly Cache, you can edit `DbMetal.exe.config` (in the DbLinq installation directory) to use an assembly-qualified type name in the `/configuration/providers/provider/@databaseConnection` attribute.  For example, if you installed `System.Data.SQLite.dll` into the GAC, you could edit `DbMetal.exe.config` and change the `/configuration/providers/provider[@name='SQLite']/@databaseConnection` attribute to `System.Data.SQLite.SQLiteConnection, System.Data.SQLite, Version=1.0.61.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139`:
{{{
<provider
    name="SQLite"
    dbLinqSchemaLoader="DbLinq.Sqlite.SqliteSchemaLoader, DbLinq.Sqlite" 
    databaseConnection="System.Data.SQLite.SQLiteConnection, System.Data.SQLite, Version=1.0.61.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139" />
}}}
  # You can use the `DbMetal.exe --with-dbconnection=TYPE` option, where TYPE is an assembly-qualified type name for the [http://msdn.microsoft.com/en-us/library/system.data.idbconnection.aspx IDbConnection] implementation to use.
{{{
DbMetal.exe \
    --provider=Sqlite \
    --with-dbconnection="Mono.Data.Sqlite.SqliteConnection, Mono.Data.Sqlite, Version=2.0.0.0, Culture=neutral, PublicKeyToken=0738eb9f132ed756" \
    ...
}}}

= To use !DbLinq =

Just as with DbMetal, using DbLinq within your app _also_ requires both an ADO.NET provider and a DbLinq provider.

There are three ways to create a `DataContext` instance.  Depending on how you create the `DataContext`, you may need to explicitly provide either the ADO.NET provider, the DbLinq provider, or both.

  # *When using a _connection string_ with the `DataContext(string)` constructor*, _both_ the ADO.NET provider _and_ the DbLinq provider need to be specified.  The ADO.NET provider is provided via the `DbLinqConnectionType` key/value pair in the connection string, while the DbLinq provider is in the `DbLinqProvider` key/value pair.  If neither is listed, then DbLinq _defaults_ to using [http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.aspx SqlConnection] for `DbLinqConnectionType` and to using `SqlServer` for `DbLinqProvider`.  ([http://msdn.microsoft.com/en-us/library/system.type.gettype.aspx Type.GetType()] is used to get the assembly-qualified type name used by `DbLinqConnectionType`, so a "full" assembly name (complete with `PublicKeyToken` may not be necessary if the assembly is an unsigned assembly and/or is in a location that `Type.GetType()` will search for, e.g. in the same directory as the launching `.exe`.)
{{{
var db = new Northwind(
    "DbLinqProvider=Sqlite;" +
    "DbLinqConnectionType=System.Data.SQLite.SQLiteConnection, System.Data.SQLite, Version=1.0.61.0, Culture=neutral, PublicKeyToken=db937bc2d44ff139" +
    "Data Source=Filename.db3"
    // + other connection string key/value pairs
);
}}}
  # *When using an existing `IDbConnection` with the `DataContext(IDbConnection)` constructor*, the `DbLinqConnectionType` key/value pair isn't necessary, as the provided `IDbConnection` instance will be used.  The `DbLinqProvider` key/value pair is required (unless you want Microsoft SQL Server support), and thus must be provided to the `IDbConnection` implementation before constructing the `DataContext`:
{{{
var connection = new SQLiteConnection(
    "DbLinqProvider=Sqlite; " +
    "Data Source=Filename.db3"
    // + other connection string key/value pairs
);
var db = new Northwind(connection);
}}}
  # *When using an existing `IDbConnection` and a provided `IVendor` implementation with the `DataContext(IDbConnection, IVendor)` constructor*, neither `DbLinqConnectionType` nor the `DbLinqProvider` key/value pairs need to be within the connection string.  Note: if using Mono's `System.Data.Linq.dll`, this option isn't available as the `DataContext(IDbConnection, IVendor)` constructor doesn't exist.
{{{
var connection = new SQLiteConnection(
    "Data Source=Filename.db3"
    // + other connection string key/value pairs
);
var db = new Northwind(connection, new DbLinq.Sqlite.SqliteVendor());
}}}

Note that in all three situations, the ADO.NET provider assembly and the DbLinq provider assembly must be present in locations that `Type.GetType()` can find them, e.g. the GAC, the same directory as your main `.exe` assembly, your webapp `bin` directory, etc.

= Why? =

There are a variety of ADO.NET providers for databases.  For example, there are two ADO.NET providers for Oracle (e.g. [http://msdn.microsoft.com/en-us/library/system.data.oracleclient.aspx System.Data.OracleClient] and [http://www.oracle.com/technology/software/htdocs/distlic.html?url=/technology/software/tech/windows/odpnet/utilsoft.html Oracle.DataAccess]), and multiple versions of the SQLite provider.  This raises two problems:

  # If DbLinq were to include an ADO.NET provider, it may be for a different version of the database you wish to use, in which case you would need to provide your own ADO.NET provider _anyway_.
  # The licensing for many providers is [http://groups.google.com/group/dblinq/msg/2981c81492fcf32a unclear] or otherwise incompatible with DbLinq's license.

We don't wish to step into a legal minefield, so for simplicity and consistency no ADO.NET providers are included with the DbLinq binaries.